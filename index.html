<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<script src="js/jquery-3.3.1.min.js"></script>
		<script src="js/vue-2.5.22.js"></script>
		<script type="text/javascript" src="js/es.js"></script>
		<link rel="stylesheet" type="text/css" href="css/estilos.css">
		<title>Finca</title>
	</head>
	<body>
        <strong>Ya estoy registrado: </strong>
        <input type="text" value="" placeholder="usuario">
        <input type="text" value="" placeholder="contraseña">
        <input type="button" value="ingresar" onclick="ingresar('Agenda/ingresar.php')">
        <br><br>
        <strong>Aún no estoy registrado: </strong>
        <input type="text" value="" placeholder="nombre">
        <input type="text" value="" placeholder="usuario">
        <input type="text" value="" placeholder="contraseña">
        <input type="text" value="" placeholder="título del registro">                
        <input type="button" value="Registrarme" onclick="registrar('Agenda/registrar.php')"> 
		<script type="text/javascript">
			function ingresar(DataBase){
				var input = document.getElementsByTagName('input');
				var datos = {"usuario" : input[0].value,"contrasena" : input[1].value};
				$.ajax({
					data: datos,
					type:'get',
					url:DataBase,
					dataType: "json",
					success: function (resultado){
						if (resultado['usuarioEstado'] == "true" && resultado['contrasenaEstado'] == "true") {
							document.location.href = 'content.html?usuario='+input[0].value+"&titulo="+resultado.titulo;
						}
					}			        
				});					
			}
			function registrar(DataBase){
				var input = document.getElementsByTagName('input');
				if (input[4].value.split(' ').length > 1) {
					alert("El nombre de usuario no debe contener espacios");
					return;
				}
				var datos = {"nombre" : input[3].value,"usuario" : input[4].value,"contrasena" : input[5].value,"titulo" : input[6].value};
				$.ajax({
					data: datos,
					type:'get',
					url:DataBase,
					dataType: "json",
					success: function (resultado){
						switch(resultado['estadoUsuario']){
							case 'OK':
								alert("El usuario fue creado con éxito");
								break;
							case 'No se pudo hacer crear el usuario':
								alert("No se pudo hacer crear el usuario");
								break;
							case 'El usuario ya existe':
								alert("El usuario ya existe");
								break;
							default:
						}
					}			        
				});					
			}			
		</script>
	</body>
	<footer>
		<div>Realizado por Juan Fernando Echavarria Zapata - fernando.echavarria@powersite.online</div>
	</footer>
</html>
