<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<script src="../../js/jquery-3.3.1.min.js"></script>
		<script src="../../js/vue-2.5.22.js"></script>
		<style type="text/css">
			tr{
				text-align: justify;
			}
			th {
			    width: 18%;
			}			
			div{
				border: solid 1px;
			}
			.em6{
				width: 6em!important;
			}
			.em8{
				width: 9em!important;
			}			
		</style>
		<title>Finca</title>
	</head>
	<body>
		<h1>Finca de Jhon Fernando</h1>
		<h3>Ganado</h3>
		 <nav>
			<a href="../../">Principal</a> |
			<a href="../../html/cafe/cafe.html">Caf√©</a> |
			<a href="../../html/ganado/ganado.html">Ganado</a> |
			<a href="../../html/cerdos/cerdos.html">Cerdos</a> |
			<a href="../../html/revuelto/revuelto.html">Revuelto</a> |
			<a href="../../html/otros/otros.html">Otros</a>
		</nav> 
		<p>
			Ingresos: <br>
			<input type="text" value="" class="ingreso" id="ingresoProducto_nombre" placeholder="nombre">
			<input type="text" value="" class="ingreso em6" id="ingresoProducto_cantidad" placeholder="cantidad">
			<input type="text" value="" class="ingreso" id="ingresoProducto_unidad" placeholder="unidad">
			<input type="text" value="" class="ingreso" id="ingresoProducto_valor" placeholder="valor">
			<input type="date" class="ingreso em8" id ="datePicker_ingreso" name="fecha">
			<input type="button" value="agregar ingreso" id="ingresarIngreso" onclick="ingresar('../../Agenda/crear.php','ingreso')">			
		</p>
		<p>
			Gasto: <br>
			<input type="text" value="" class="gasto" id="gastoProducto_nombre" placeholder="nombre">
			<input type="text" value="" class="gasto em6" id="gastoProducto_cantidad" placeholder="cantidad">
			<input type="text" value="" class="gasto" id="gastoProducto_unidad" placeholder="unidad">
			<input type="text" value="" class="gasto" id="gastoProducto_valor" placeholder="valor">
			<input type="date" class="gasto em8" id ="datePicker_gasto" name="fecha">
			<input type="button" value="agregar gasto" id="ingresarGasto" onclick="ingresar('../../Agenda/crear.php','gasto')">	
		</p>	
		<p>		
			Busqueda: <br>
			<input type="text" value="" class="busqueda" placeholder="nombre">
			<input type="text" value="" class="busqueda em6" placeholder="cantidad">
			<input type="text" value="" class="busqueda" placeholder="unidad">
			<input type="text" value="" class="busqueda" placeholder="valor">
			<input type="text" value="" class="busqueda" placeholder="AAAA" style="width: 4em">
			<input type="text" value="" class="busqueda" placeholder="MM" style="width: 2em">
			<input type="text" value="" class="busqueda" placeholder="DD" style="width: 2em">
			<input type="button" value="Buscar" id="realizarBusqueda" onclick="buscar('../../Agenda/buscar.php','ganado')">	
		</p>		
		<!--<input type="button" value="buscar" onclick="buscar('../../Agenda/buscar.php','ganado')">-->
		<div id="resultadosBusqueda_ingresos">
			<h3>Ingresos: <strong id="ingreso"></strong></h3>
			<table style="width: 100%">
				<tr><th>Producto</th><th>Cantidad</th><th>Unidad</th><th>Valor</th><th>Fecha</th><th>Tipo</th></tr>
				<tr v-for="dato in datos"><td>{{dato.nombre}}</td><td>{{dato.cantidad}}</td><td>{{dato.unidad}}</td><td>{{dato.valor}}</td><td>{{dato.fecha}}</td><td>{{dato.tipo}}</td></tr>
			</table>			
		</div>
		<div id="resultadosBusqueda_gastos" style="margin-top: 1em">
			<h3>Gastos: <strong id="gasto"></strong></h3>
			<table style="width: 100%">
				<tr><th>Producto</th><th>Cantidad</th><th>Unidad</th><th>Valor</th><th>Fecha</th><th>Tipo</th></tr>
				<tr v-for="dato in datos"><td>{{dato.nombre}}</td><td>{{dato.cantidad}}</td><td>{{dato.unidad}}</td><td>{{dato.valor}}</td><td>{{dato.fecha}}</td><td>{{dato.tipo}}</td></tr>
			</table>			
		</div>			
		<script type="text/javascript">
	        var v_ingreso = new Vue ({
	            el : "#resultadosBusqueda_ingresos",
	            data : {
	                datos: ""
	            }
	        });	
	        var v_gasto = new Vue ({
	            el : "#resultadosBusqueda_gastos",
	            data : {
	                datos: ""
	            }
	        });						
			window.onload = function(){
				buscar('../../Agenda/buscar.php','ganado');
			}			
			document.getElementById('datePicker_ingreso').valueAsDate = new Date();
			document.getElementById('datePicker_gasto').valueAsDate = new Date();
			function ingresar(DataBase,dinero){
				var datos;
				var ingresos = document.getElementsByClassName("ingreso");
				if (dinero == 'gasto') {
					ingresos = document.getElementsByClassName("gasto");
				}
				datos = {"nombre" : ingresos[0].value,"cantidad" : ingresos[1].value,"unidad" : ingresos[2].value,"valor" : ingresos[3].value,"fecha" : ingresos[4].value,"tipo" : 'ganado', "dinero" : dinero};
			    $.ajax({
			        data: datos,
			        type:'get',
			        url:DataBase,
			        dataType: "json",
			        success: function (resultado){
			        	window.location.href = '';
			        }			        
			    });				
			}
			function buscar(DataBase, busqueda){
				var datosBusqueda = document.getElementsByClassName("busqueda");
			    $.ajax({
			        data: {"dinero" : 'ingresos',
			    			"busqueda" : busqueda,
			    			"nombre" : datosBusqueda[0].value,
			    			"cantidad" : datosBusqueda[1].value,
			    			"unidad" : datosBusqueda[2].value,
			    			"valor" : datosBusqueda[3].value,
			    			"ano" : datosBusqueda[4].value,
			    			"mes" : datosBusqueda[5].value,
			    			"dia" : datosBusqueda[6].value},
			        type:'get',
			        url:DataBase,
			        dataType: "json",
			        success: function (resultado){
			        	v_ingreso.datos = resultado;
			            var total=0;
			            for (var i = 0; i < resultado.length; i++) {
			            	total+=parseInt(resultado[i].valor);
			            }
			            document.getElementById("ingreso").innerHTML=total;			            
			        }
			    });
			    $.ajax({
			        data: {"dinero" : 'gastos',
			    			"busqueda" : busqueda,
			    			"nombre" : datosBusqueda[0].value,
			    			"cantidad" : datosBusqueda[1].value,
			    			"unidad" : datosBusqueda[2].value,
			    			"valor" : datosBusqueda[3].value,
			    			"ano" : datosBusqueda[4].value,
			    			"mes" : datosBusqueda[5].value,
			    			"dia" : datosBusqueda[6].value},
			        type:'get',
			        url:DataBase,
			        dataType: "json",
			        success: function (resultado){
			        	v_gasto.datos = resultado;
			            var total=0;
			            for (var i = 0; i < resultado.length; i++) {
			            	total+=parseInt(resultado[i].valor);
			            }
			            document.getElementById("gasto").innerHTML=total;			            
			        }
			    });			    
			}		
		</script>		
	</body>
</html>